<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Personal Blog of Bodun (Edward) Hu. CS PhD student at University of Texas at Austin. Operating systems, network, heterogeneity, MLSys, anything system. UTCS">
<link rel="shortcut icon" href=https://www.bodunhu.com/blog/favicon.ico>
<link rel=stylesheet href=/blog/css/style.min.css>
<script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']]},svg:{fontCache:'global'}}</script>
<script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-108144808-1','auto'),ga('send','pageview'))</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-108144808-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
<link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css rel=stylesheet>
<title>Blockchain</title>
</head>
<body><header id=banner>
<h2><a href=https://www.bodunhu.com/blog/>std::bodun::blog</a></h2>
<nav>
<ul>
<li>
<a href=/blog/posts/ title=posts>archive</a>
</li><li>
<a href=https://www.bodunhu.com/ title=about>about</a>
</li>
</ul>
</nav>
</header>
<main id=content>
<article>
<header id=post-header>
<h1>Blockchain</h1>
<div>
Updated <time>May 14, 2021</time>
</div>
</header><p>The first time I&rsquo;ve heard the term &ldquo;blockchain&rdquo; was around 2014. Since then, its popularity has grown rapidly. However, I&rsquo;ve never actually understand what blockchain is exactly, until recently. In fact, I didn&rsquo;t really understand the difference between blockchain and bitcoin. For me, blockchain is clubbed with cryptocurrencies. So here is a short summary of what blockchain is and why people use blockchain.</p>
<h2 id=what-is-blockchain>What is Blockchain</h2>
<p>I tried reading the articles about blockchain before, and it didn&rsquo;t take long before I was completely overwhelmed by technical terms: consensus, asymmetric crypto, consistency, etc. It&rsquo;s hard to combine all these little pieces together and form a big picture. Instead, it&rsquo;s much easier to understand block-chain from a top-to-bottom view. Even better, a small step-by-step example can clarify much of the confusion. I like Prof. Anand&rsquo;s example given in the class slides:</p>
<ul>
<li>
<p>Supposed we own a comic book store, and we want to sell comic books to some customer.</p>
</li>
<li>
<p>Every time we sell a book, 10 of my friends will record the action. Traditionally, we refer to such record as &lsquo;&lsquo;ledger&rsquo;&rsquo;. In the world of blockchain, we call this &lsquo;&lsquo;distributed ledger&rsquo;&rsquo;.</p>
</li>
<li>
<p>Once we sell enough comic books, the 10 records (ledgers) will be collected into a book, all of my friends will get a copy of the book. This is very important because we use duplication to achieve consensus.</p>
</li>
<li>
<p>To make things more secure, all these books are stored in a secure vault. In digital world, we achieve this though ways of encryption, digital signature, and so on. An attacker need to tamper many copies of such book to disrupt our selling records, which tends to be extremely hard in real world scenario.</p>
</li>
<li>
<p>Now we have this secure vault, which is effectively an immutable block. This block (vault) stores the record of we selling a comic book.
If we decide to sell more books, each one will generate an additional block (vault). Each block is appended after the previous block, forming what we call a &lsquo;&lsquo;blockchain&rsquo;&rsquo;.</p>
</li>
</ul>
<p>In essence, a blockchain is a series of immutable blocks, each storing the information of an event(s) whose validity is approved by a majority of other participants. Simple as that.</p>
<p>I like using the term &lsquo;&lsquo;distributed ledger&rsquo;&rsquo; to characterize blockchain. In Prof. Anand&rsquo;s slides, this graph summarizes how a distributed ledger differs from traditional centralized ledger:</p>
<p><img src=https://raw.githubusercontent.com/BDHU/Page_pics/master/posts/blockchain/ledger.png alt=hyperledger></p>
<p>The main difference is how consensus is achieved. In centralized ledger, we have a single that decides the &lsquo;&lsquo;golden record&rsquo;&rsquo;. In a distributed ledger, consensus is achieved is everybody agrees with it. To give an example, we would pay a 45-dollar electricity bill each month to Texas electricity company because the price standard is set by the company alone. In a distributed ledger world, we might pay 32 dollars instead, if every single residents living in the building agrees this is the best price. Essentially, we eliminate the centralized entity and distribute the ability of making decisions to each individual evenly.</p>
<p>In super-simple terms, a blockchain is just a computer file for storing data. The reason why it&rsquo;s so secure is because there doesn&rsquo;t exist a single central point of attack for hackers to target.</p>
<h2 id=sketch-on-blockchain>Sketch on Blockchain</h2>
<p>Now we understand what a blockchain is, it&rsquo;s time to find out how blockchain enables the development of digital currencies such as Bitcoin.
There are many great articles talking about Bitcoin in details, but I found the original <a href=https://nakamotoinstitute.org/bitcoin/>paper</a> extremely helpful in terms of understanding the motivation behind Bitcoin. In essence, Bitcoin was introduced to eliminate one problem: the need of a trusted third party to process electronic payments. More abstractly, shift from trust-based system to cryptographic-proof-based system.</p>
<p>Tha paper claims that trust based model suffers from a fundamental weakness: the need of mediation. The logic is simple: mediation is required in the presence of disputes. Disputes means making non-reversible transactions more difficult, thus comes the possibility of reversal. Reversal causes the need for trust to spread. To establish trust, more price needs to be paid, in the form of money, personal information, etc. Essentially, the need of trust creates a centralized component that participants must rely on. In theory, Bitcoin resorts to a cryptographic-proof based system to replace the trust-based system, with the difference being that cryptographic-proof based system is distributed in nature.</p>
<p>Imaging a distributed system as a fully connected graph with \(n\) nodes where each node represents a buyer/buyer. A transaction represents an edge connecting two nodes together. We denote set \(T\) as currently ongoing transactions, there could be as many as \(n(n-1)\) transactions going on concurrently, and each transaction \(t \in T\) is independent to each other. There enables 1) extremely scalability; 2) on reliance on central components. If a transaction is committed to a Bitcoin network, it suggests that the transaction has already gained approval from both the buyer and seller side (why this is the case is more technical, and you should Google how symmetric and asymmetric encryption work).</p>
<p>If we imaging a centralized system, where every buyer node is connected to one node \(c\). Node \(c\) in turn is connected to every seller node \(s\). Assume the centralized component, or node \(c\), has a fixed capacity limiting the amount of traffic flowing thought it in any given moment. To achieve the same level of information flow in a distributed system, we need to increase node \(c\)&rsquo;s capacity, which represents the increased costs of mediation. Assume a buyer node \(b\)&rsquo;s output value is different from a seller node \(s\)&rsquo;s input value (disputes), extra information flow will be required from seller node \(s\), creating the need for more capacity at node \(c\), thus driving the cost.</p>
<p>From an abstract point of view, I&rsquo;d like to imaging a normal transaction in a Bitcoin network as follows:</p>
<ol>
<li>
<p>Transaction is initiated</p>
</li>
<li>
<p>The buy, the seller, and all witnesses agree with the validity of such transaction.</p>
</li>
<li>
<p>With everyone satisfied as the precondition, transaction completes. If there exists a disagreement, transaction doesn&rsquo;t happen.</p>
</li>
</ol>
<p>On the other hand, in a centralized system, the transaction happens as follows:</p>
<ol>
<li>
<p>Transaction is initiated</p>
</li>
<li>
<p>Seller received payments, but there&rsquo;s a mismatch</p>
</li>
<li>
<p>Now the centralized component must be engaged to mitigate the issue.</p>
</li>
<li>
<p>More shit happens, the centralized component must constantly nag both the buyer and the seller until the problem is solved.</p>
</li>
</ol>
<p>In short, I think trust is not &lsquo;&lsquo;removed&rsquo;&rsquo;, it is merely achieved through a different way. I&rsquo;d like to modify Prof. Anand&rsquo;s summary on Bitcoin: Bitcoin is an engineering solution to solve trust issues.</p>
<h2 id=blockchain-structure>Blockchain Structure</h2>
<p>The structure of blockchain is surprisingly simple. A blockchain consists a series of blocks, each holding batches of valid transactions that are hashed and encoded into a <a href=https://en.wikipedia.org/wiki/Merkle_tree>Merkle tree</a>, with only the root of the tree included in the block&rsquo;s hash. Each block also includes a hash value of prior block in the blockchain. The essentially forms a linked list, except we replaced pointer with a hash value of a block.</p>
<p><img src=https://raw.githubusercontent.com/BDHU/Page_pics/d237cddc277de92e56a762d91ef91e13d0b0fe58/posts/blockchain/block_chain_structure.png alt=blockchain_structure></p>
<p>Using hash value to link block has another benefit that it protects the integrity of all previous blocks. For example, if an attacker modifies the data in one block, the action will consequently change the block&rsquo;s corresponding hash value, resulting the hash value stored in the next block being invalidated. The attack needs to modify hash values starting from the modified block all the way to the latest block. In addition, the modified blockchain would be different compared the one stored in other nodes across the internet, making attacking even more difficult.</p>
<h3 id=mining>Mining</h3>
<p>After explaining the basic concepts behind blocks, it becomes easy to understand the purpose of mining. Mining, in its essence, is using proof-of-work to implement a distributed timestamp server on a P2P bases.</p>
<p>What a miner does is incrementing the nonce in a block until a value is found that would result in a block&rsquo;s hash with required beginning zero bits. It is that simple 😄. The more the number of zero bits required, the more work is needed to derive such hash value.</p>
<p>Once thing one might ask is: it could be possible that there are multiple miners producing blocks with hash values satisfying such requirement. In that case, how should we determine which miner&rsquo;s blocks get accepted? The original <a href=https://nakamotoinstitute.org/bitcoin/>paper</a> paper explains that the proof-of-work also solves the problem of determining representation in majority decision making. The majority decision is represented by the <strong>longest</strong> chain. That&rsquo;s it! The longest chain means a miner is able to produce many blocks that satisfy the zero bit requirement, thus showing the greatest proof-of-work effort invested.</p>
<p>What is suggests, in layman&rsquo;s term, is that whoever gets the most computational power has higher probability of generating new blocks and thus getting rewarded with bitcoins. That&rsquo;s why people are craving for GPUs, FPGAs, and other accelerators because they are much better at parallel computing and have higher throughput than CPUs.</p>
<p>Personally, I have doubts on the way proof-of-work is implemented. Normally, proof-of-work, for example, can be providing technical support to customers, or helping cleaning your neighbor&rsquo;s backyard. The work you did has created positive values to the society. In the bitcoin case, the work was simply spending electricity to derive a value, which is hard to argue about its value. One way to justify its value might be that it provides a fundamental service so that blockchain can function properly and smoothly. Even then, it still feels like a bubble, not to mention the massive amount of resources wasted. Could there be another way to implement proof-of-work? If calculating the nonce value takes a long time, could we use waiting time instead to mimic the same result while saving resources in the same time?</p>
<p><strong>Update</strong>: Recently, a new cyptocurrency called <a href=https://www.chia.net/>Chia</a> was introduced and caught my attention. It was developed by the inventor of BitTorrent, <a href=https://en.wikipedia.org/wiki/Bram_Cohen>Bram Cohen</a>. It uses proof of space and time to replace the energy-hungry proof of work approach. In short terms, the way it works is: whenever the blockchain broadcasts a challenge for the next block, farmers scan their plots to see if they have the hash closest to the puzzle. The probability of winning a block the roughly proportional to the total space a farmer has compared to the entire network.</p>
<p>Obviously, the demand for storage devices will increase dramatically. In fact, according to <a href=https://www.tomshardware.com/news/chia-network-now-uses-more-than-1-exabyte-for-storage>Tom&rsquo;s Hardware</a>, in about a month&rsquo;s time storage space allocated to Chia network increased from 120PB all the way to 1143PB, or 1.14 Exabytes. 1.14EB equals 1,140,000TB, or 63,333 20TB hard drives. Looking back at proof-of-work, it feels like choosing between one evil and another.</p>
<p><img src=https://cdn.mos.cms.futurecdn.net/3sV9LasTQiSqw6scuN5uQg-970-80.png alt=chia-storage></p>
<h3 id=transaction>Transaction</h3>
<p>Transactions are the most part in the bitcoin system. It is represented as data structures that encode the transfer of value between participants. There are many fields in a transaction structure. But the most important components are: <em>input and output</em>.</p>
<p>The best way to understand how transaction works is through an example. Suppose we have sender \(A\) and receiver \(B\). To send some BTC to receiver \(B\). \(A\) signs a transaction using his private key with specific details. This message is sent to the bitcoin network, the message contains:</p>
<ul>
<li>input: the source transaction sent to \(A\) at an earlier time.</li>
<li>amount: amount of BTC to sent to \(B\).</li>
<li>output: \(B\)&rsquo;s public address.</li>
</ul>
<p>Here, the miners will verify whether \(A\) actually have access to the funds he/she claims to control using \(A\)&rsquo;s public key. Upon verification, new blocks will be created.</p>
<p><strong>Note</strong>: to actually understand how public and private key works, please refer to <a href=https://en.wikipedia.org/wiki/Public-key_cryptography>public-key cryptography</a>, <a href=https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange>Diffie-Hellman algorithm</a>, and the use of <a href=https://brilliant.org/wiki/public-key-cryptography/>number theory</a> in encryption.</p>
<div style=width:100% id=comment>
<script src=https://utteranc.es/client.js repo=BDHU/blog issue-term=pathname theme=preferred-color-scheme crossorigin=anonymous async></script>
</div>
</article>
</main><footer id=footer>
<p>Copyright © 2021 Bodun Hu. All rights reserved.</p>
</footer></body>
</html>