<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="This paper by [UTNS](https://utns.cs.utexas.edu/) lab appeared in [NSDI 2021](https://www.usenix.org/conference/nsdi21). It presents a data-analytics framework that decouples intermediate data from computations"><link rel="shortcut icon" href=/blog/favicon.ico><link rel=stylesheet href=/blog/css/style.min.65fee12c3de7945505d2df881b53ad9402a1780736bd4aa18e7383244352f41c.css integrity="sha256-Zf7hLD3nlFUF0t+IG1OtlAKheAc2vUqhjnODJENS9Bw=" crossorigin=anonymous><script>MathJax={tex:{inlineMath:{"[+]":[["$","$"],["\\(","\\)"]]}},svg:{fontCache:"global"},output:{displayOverflow:"linebreak",linebreaks:{inline:!0,width:"100%",lineleading:.2,LinebreakVisitor:null}}}</script><script defer src=https://cdn.jsdelivr.net/npm/mathjax@4/tex-svg.js></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZLK2GHB055"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-ZLK2GHB055")}</script><link rel=canonical href=https://www.bodunhu.com/blog/posts/whiz-data-driven-analytics-execution/><title>Whiz: Data-Driven Analytics Execution | std::bodun::blog</title></head><body><header class=banner><nav class=site-nav aria-label=Primary><a href=/blog/ title=blog>blog</a> | <a href=/blog/posts/ title=posts>posts</a> | <a href=https://www.bodunhu.com/ title=about>about</a></nav></header><main class=content><article><header class=post-header><h1>Whiz: Data-Driven Analytics Execution</h1><div><time datetime=2023-04-19>April 19, 2023</time></div></header><p>This paper by <a href=https://utns.cs.utexas.edu/>UTNS</a> lab appeared in <a href=https://www.usenix.org/conference/nsdi21>NSDI 2021</a>. It presents a data-analytics framework that decouples intermediate data from computations.</p><p>Whiz addresses several challenged posed by current analytics frameworks. The first one is data opacity. Most modern data analytics frameworks relies on MapReduce execution engine. The developer specifies the map and reduce function, which then get submitted to the analytics framework. The workflow can be expressed as a logical graph; the physical graph (which includes the cluster configuration, disk quota, etc.) is generated transparently. The workflow is shown below:</p><p><img src=https://cdn.jsdelivr.net/gh/BDHU/Page_Pics/posts/whiz-data-driven-analytics-execution/limitation1.png#center alt=mapreduce-limitation></p><p>The problem is in the region marked yellow. It shows the execution engine has limited runtime visibility into the intermediate data. Thus, adapting processing logic of tasks based on the states of intermediate data becomes challenging.</p><p>In addition, task parallelism and intermediate data partition strategy are often static. In the graph above, the intermediate data partition tasks and the final reduce tasks might be determined prematurely, without taking the intermediate data partition characteristics into account. For example, <a href=https://itnext.io/handling-data-skew-in-apache-spark-9f56343e58e8>data skew</a> (unevenly distributed jobs) causes different reduce nodes to process different amount of tasks. The graph below illustrates how the shuffle stage can result in disproportional intermediate data partitions.</p><p><img src=https://cdn.jsdelivr.net/gh/BDHU/Page_Pics/posts/whiz-data-driven-analytics-execution/data-skew.png#center alt=data-skew></p><p>Finally, Whiz addresses the limitation posed by compute-driven scheduling. In compute-driven scheduling, one stage usually relies on the completion of the upstream tasks, the may lead to compute idling waiting for remaining data to become available, even if the a subset of workers in the current stage is ready for execution. Decoupling data from computation enables the execution engine to treat intermediate data as first-class citizen, thus allowing finer-grained control of data processing.</p><p>In summary, Whiz solves two problems presented in compute-centric execution engines:</p><ul><li>Tight coupling between intermediate data and compute.</li><li>intermediate data agnosticity.</li></ul><p>Thus, Whiz creates a feedback loop between the execution service and the data service so that the execution can dynamically adjust its policy based on the information offered by the data service to optimize system performances.</p><p><img src=https://cdn.jsdelivr.net/gh/BDHU/Page_Pics/posts/whiz-data-driven-analytics-execution/whiz-control-flow.png#center alt=whiz-control-flow></p><p>Whiz classifies itself as a <strong>data-driven</strong> execution engine, which drives execution based on intermediate data properties. Making intermediate data visible opens door for optimization opportunities, thus increasing performances. For more technical details regarding the architecture and implementation of Whiz, please refer to the original <a href=https://www.usenix.org/system/files/nsdi21-grandl.pdf>paper</a>.</p><script src=https://giscus.app/client.js data-repo=BDHU/blog-comments data-repo-id=R_kgDOKZLDLA data-category=Announcements data-category-id=DIC_kwDOKZLDLM4CZrU- data-mapping=pathname data-strict=0 data-reactions-enabled=0 data-emit-metadata=0 data-input-position=bottom data-theme=light data-lang=en crossorigin=anonymous async></script></article></main><footer><p>Copyright Â© 2026 <a href=https://www.bodunhu.com/>Bodun Hu</a>&nbsp;&bull; <a href=/blog/index.xml>RSS</a></p></footer></body></html>