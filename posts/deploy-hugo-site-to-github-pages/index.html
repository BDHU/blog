<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Deploy Hugo Site to GitHub Pages</title><link rel=stylesheet href=https://www.bodunhu.com/blog/css/colors-preference.min.79f305c614b4ceb62b5bba50782f7c04f68b58d85622e7a8bf1c71f396386716.css><link rel="shortcut icon" href=https://www.bodunhu.com/blog/favicon.ico><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]},svg:{fontCache:"global"}}</script><script type=text/javascript id=MathJax-script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js async></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-108144808-1","auto"),ga("send","pageview"))</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-108144808-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><header id=header><h1><a href=https://www.bodunhu.com/blog/>std::bodun::blog</a></h1><p>PhD student at University of Texas at Austin ðŸ¤˜. Doing systems for ML.</p></header><div id=page><div id=sidebar><nav><ul class=nav><li><a href=/blog/posts/><span>Archive</span>&nbsp;</a></li><li><a href=https://www.bodunhu.com/><span>About</span>&nbsp;</a></li><li><a href=/blog/index.xml><span>Feed</span>&nbsp;</a></li></ul></nav></div><div id=content><article class=post><h1><a href=https://www.bodunhu.com/blog/posts/deploy-hugo-site-to-github-pages/>Deploy Hugo Site to GitHub Pages</a></h1><div class=post-content><p>This post assumes the user has already setup two separate repositories: a private repository for Hugo source files, and a public repository for <a href=https://pages.github.com/>GitHub Pages</a>.</p><p><em>Note: test Hugo site by executing <code>hugo server</code> in the source code directory to make sure the site is generated properly.</em></p><p>Then, we need to generate a pair of keys by using the following command:</p><div class=highlight><pre tabindex=0 style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ssh-keygen -t rsa -b <span style=color:#00afaf>4096</span> -C <span style=color:#00afaf>&#34;</span><span style=color:#5f8700>$(</span>git config user.email<span style=color:#5f8700>)</span><span style=color:#00afaf>&#34;</span> -f deployment -N <span style=color:#00afaf>&#34;&#34;</span>
</span></span></code></pre></div><p>This will create two files: <code>deployment</code> and <code>deployment.pub</code>, which corresponds to a private key and a public key.</p><p>Next, execute <code>cat deployment</code> and copy the private key. Navigate to the private <em>source repository -> Settings -> Secrets -> New repository secret</em>. Paste the private key and save the change.</p><p><img src=https://cdn.jsdelivr.net/gh/BDHU/Page_Pics/posts/deploy-hugo-site-to-github-pages/github-actions-secrets.png alt=Github-actions-secrets></p><p>I&rsquo;ve already added the private key to the source directory and named it <code>PRIVATE_KEY</code>. You can named it however you want.</p><p>Then, we go to the public repository for hosting our website. Navigate to the public <em>site repository -> Settings -> Deploy keys -> Add deploy key</em>. Execute <code>cat deployment.pub</code> and copy paste the result. You should see a SSH key added:</p><p><img src=https://cdn.jsdelivr.net/gh/BDHU/Page_Pics/posts/deploy-hugo-site-to-github-pages/github-keys.png alt=Github-keys></p><p>Finally, create a directory in the private repository in the following directory: <code>.github/workflows/deploy.yml</code>.</p><div class=highlight><pre tabindex=0 style=color:#8a8a8a;background-color:#1c1c1c;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#0087ff>name</span>: github pages
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0087ff>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#0087ff>push</span>:
</span></span><span style=display:flex><span>    <span style=color:#0087ff>branches</span>:
</span></span><span style=display:flex><span>      - main  <span style=color:#4e4e4e># Set a branch to deploy</span>
</span></span><span style=display:flex><span>  <span style=color:#0087ff>pull_request</span>:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#0087ff>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#0087ff>deploy</span>:
</span></span><span style=display:flex><span>    <span style=color:#0087ff>runs-on</span>: ubuntu-20.04
</span></span><span style=display:flex><span>    <span style=color:#0087ff>steps</span>:
</span></span><span style=display:flex><span>      - <span style=color:#0087ff>uses</span>: actions/checkout@v2
</span></span><span style=display:flex><span>        <span style=color:#0087ff>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#0087ff>submodules</span>: <span style=color:#d75f00>true</span>  <span style=color:#4e4e4e># Fetch Hugo themes (true OR recursive)</span>
</span></span><span style=display:flex><span>          <span style=color:#0087ff>fetch-depth</span>: <span style=color:#00afaf>0</span>    <span style=color:#4e4e4e># Fetch all history for .GitInfo and .Lastmod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#0087ff>name</span>: Setup Hugo
</span></span><span style=display:flex><span>        <span style=color:#0087ff>uses</span>: peaceiris/actions-hugo@v2
</span></span><span style=display:flex><span>        <span style=color:#0087ff>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#0087ff>hugo-version</span>: <span style=color:#00afaf>&#39;latest&#39;</span>
</span></span><span style=display:flex><span>          <span style=color:#0087ff>extended</span>: <span style=color:#d75f00>true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#0087ff>name</span>: Build
</span></span><span style=display:flex><span>        <span style=color:#0087ff>run</span>: hugo --minify
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      - <span style=color:#0087ff>name</span>: Deploy
</span></span><span style=display:flex><span>        <span style=color:#0087ff>uses</span>: peaceiris/actions-gh-pages@v3
</span></span><span style=display:flex><span>        <span style=color:#0087ff>with</span>:
</span></span><span style=display:flex><span>          <span style=color:#0087ff>deploy_key</span>: ${{ secrets.PRIVATE_KEY }}
</span></span><span style=display:flex><span>          <span style=color:#0087ff>external_repository</span>: your_username/public_repository_name
</span></span><span style=display:flex><span>          <span style=color:#0087ff>publish_branch</span>: branch_to_publish
</span></span><span style=display:flex><span>          <span style=color:#0087ff>publish_dir</span>: ./public
</span></span></code></pre></div><p>Finally, make sure you create a file named <code>.nojekyll</code> in the root directory of the public repository to prevent GitHub Pages from building the site using Jekyll.</p><p>Every time you make commits to the private repository, the site will be automatically generated and published on the public repository.</p></div><p class=meta>Posted on <span class=postdate>27. August 2021</span></p></article></div><footer id=footer><p class=copyright><p>Â© 2022 <a href=https://www.bodunhu.com>Bodun Hu</a>. All rights reserved.</p></p></footer></div></body></html>